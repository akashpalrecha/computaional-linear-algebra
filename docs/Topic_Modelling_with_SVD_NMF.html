---

title: Topic Modelling with NMF and SVD

keywords: fastai
sidebar: home_sidebar

summary: "Notes, explanations, interpretations and experiments for Lesson 2 of the course"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_Topic_Modelling_with_SVD_NMF.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Topic-Modelling-with-NMF-and-SVD">Topic Modelling with NMF and SVD<a class="anchor-link" href="#Topic-Modelling-with-NMF-and-SVD">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Notes, explanations and experiments for Lesson 2 of the course</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Topic modeling is a great way to get started with matrix factorizations. We start with a <strong>term-document matrix</strong>:</p>
<p>{% include image.html alt="term-document matrix" style="width: 80%" file="/computational-linear-algebra/images/document_term.png" %}
(source: <a href="http://player.slideplayer.com/15/4528582/#">Introduction to Information Retrieval</a>)</p>
<p>We can decompose this into one tall thin matrix times one wide short matrix (possibly with a diagonal matrix in between).</p>
<p>Notice that this representation does not take into account word order or sentence structure.  It's an example of a <strong>bag of words</strong> approach.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Motivation">Motivation<a class="anchor-link" href="#Motivation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll take a dataest of documents in several different categories and cluster it into topics using two unsupervised approaches: <strong>Singular Value Decomposition(SVD)</strong> and <strong>Non Negative Matrix Factorization (NMF)</strong></p>
<p>The dataset also contains the actual topics for each topic, and that will help us in knowing whether our approaches actually make sense</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Resource-and-tutorials:">Resource and tutorials:<a class="anchor-link" href="#Resource-and-tutorials:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="http://scikit-learn.org/stable/datasets/twenty_newsgroups.html">Data source</a>: Newsgroups are discussion groups on Usenet, which was popular in the 80s and 90s before the web really took off.  This dataset includes 18,000 newsgroups posts with 20 topics.</li>
<li><a href="https://nlp.stanford.edu/IR-book/pdf/18lsi.pdf">Chris Manning's book chapter</a> on matrix factorization and LSI </li>
<li><p>Scikit learn <a href="http://scikit-learn.org/stable/modules/decomposition.html#lsa">truncated SVD LSI details</a></p>
</li>
<li><p><a href="http://scikit-learn.org/stable/auto_examples/applications/plot_out_of_core_classification.html">Scikit-Learn: Out-of-core classification of text documents</a>: uses <a href="https://archive.ics.uci.edu/ml/datasets/reuters-21578+text+categorization+collection">Reuters-21578</a> dataset (Reuters articles labeled with ~100 categories), HashingVectorizer</p>
</li>
<li><a href="https://de.dariah.eu/tatom/index.html">Text Analysis with Topic Models for the Humanities and Social Sciences</a>: uses <a href="https://de.dariah.eu/tatom/datasets.html">British and French Literature dataset</a> of Jane Austen, Charlotte Bronte, Victor Hugo, and more</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setting-up-and-looking-at-the-Data">Setting up and looking at the Data<a class="anchor-link" href="#Setting-up-and-looking-at-the-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;alt.atheism&#39;</span><span class="p">,</span> <span class="s1">&#39;talk.religion.misc&#39;</span><span class="p">,</span> <span class="s1">&#39;comp.graphics&#39;</span><span class="p">,</span> <span class="s1">&#39;sci.space&#39;</span><span class="p">]</span>
<span class="n">remove</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;headers&#39;</span><span class="p">,</span> <span class="s1">&#39;footers&#39;</span><span class="p">,</span> <span class="s1">&#39;quotes&#39;</span><span class="p">)</span>
<span class="n">newsgroups_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="n">remove</span><span class="p">)</span>
<span class="n">newsgroups_test</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="n">remove</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">filenames</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((2034,), (2034,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">newsgroups_train</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Hi,

I&#39;ve noticed that if you only save a model (with all your mapping planes
positioned carefully) to a .3DS file that when you reload it after restarting
3DS, they are given a default position and orientation.  But if you save
to a .PRJ file their positions/orientation are preserved.  Does anyone
know why this information is not stored in the .3DS file?  Nothing is
explicitly said in the manual about saving texture rules in the .PRJ file. 
I&#39;d like to be able to read the texture rule information, does anyone have 
the format for the .PRJ file?

Is the .CEL file format available from somewhere?

Rych


Seems to be, barring evidence to the contrary, that Koresh was simply
another deranged fanatic who thought it neccessary to take a whole bunch of
folks with him, children and all, to satisfy his delusional mania. Jim
Jones, circa 1993.


Nope - fruitcakes like Koresh have been demonstrating such evil corruption
for centuries.

 &gt;In article &lt;1993Apr19.020359.26996@sq.sq.com&gt;, msb@sq.sq.com (Mark Brader) 

MB&gt;                                                             So the
MB&gt; 1970 figure seems unlikely to actually be anything but a perijove.

JG&gt;Sorry, _perijoves_...I&#39;m not used to talking this language.

Couldn&#39;t we just say periapsis or apoapsis?

 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">target</span><span class="p">[:</span><span class="mi">3</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;comp.graphics&#39;, &#39;talk.religion.misc&#39;, &#39;sci.space&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># All the categories</span>
<span class="n">X</span><span class="o">.</span><span class="n">target_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;alt.atheism&#39;, &#39;comp.graphics&#39;, &#39;sci.space&#39;, &#39;talk.religion.misc&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We will assume that we do not know the actual topics and guess that there are 6 of them</span>
<span class="n">num_topics</span><span class="p">,</span> <span class="n">num_top_words</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span><span class="p">,</span> <span class="n">TfidfVectorizer</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="n">vectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
<span class="n">vectors</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(2034, 26576)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>
<span class="n">vocab</span><span class="p">[</span><span class="mi">5000</span><span class="p">:</span><span class="mi">5020</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;brow&#39;, &#39;brown&#39;, &#39;browning&#39;, &#39;browns&#39;, &#39;browse&#39;, &#39;browsing&#39;,
       &#39;bruce&#39;, &#39;bruces&#39;, &#39;bruise&#39;, &#39;bruised&#39;, &#39;bruises&#39;, &#39;brunner&#39;,
       &#39;brush&#39;, &#39;brushmapping&#39;, &#39;brushmaps&#39;, &#39;brussel&#39;, &#39;brutal&#39;,
       &#39;brutally&#39;, &#39;brute&#39;, &#39;bryan&#39;], dtype=&#39;&lt;U80&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Singular-Value-Decomposition-(SVD)">Singular Value Decomposition (SVD)<a class="anchor-link" href="#Singular-Value-Decomposition-(SVD)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"SVD is not nearly as famous as it should be" - Gilbert Strang</p>
<p>{% include image.html alt="" style="width: 80%" file="/computational-linear-algebra/images/svd_fb.png" %}
(source: <a href="https://research.fb.com/fast-randomized-svd/">Facebook Research: Fast Randomized SVD</a>)</p>
<p>The SVD algorithm factorizes a matrix into two matrices:</p>
<ol>
<li>One with all columns orthogonal</li>
<li>One with all rows orthogonal<blockquote><p>In a column orthogonal matrix <code>V</code>: <code>V.T</code> <em> <code>V</code> would result into an identity matrix</em>But Why are they orthogonal?*</p>
</blockquote>
</li>
</ol>
<p>When SVD factorizes a matrix, it does it in a way that each column of the first matrix <code>U</code> has a row for each word/document and each column represents the correlation of that word with a particular topic in the dataset. So it's natural that words that appear most frequently in one topic wouldn't appear in the other, otherwise that wouldn't be a good choise to separate out the two topics. Therefore, we expect the columns to be orthogonal. A similar explanation goes for the rows of the matrix <code>V</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SVD is an <strong>exact decomposition</strong>, since the matrices it creates are big enough to fully cover the original matrix. SVD is extremely widely used in linear algebra, and specifically in data science, including:</p>
<ul>
<li>semantic analysis</li>
<li>collaborative filtering/recommendations (<a href="https://datajobs.com/data-science-repo/Recommender-Systems-%5BNetflix%5D.pdf">winning entry for Netflix Prize</a>)</li>
<li>calculate Moore-Penrose pseudoinverse</li>
<li>data compression</li>
<li>principal component analysis (will be covered later in course)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's better understand the above diagram</p>
<hr>
<p>Take <code>U</code>.<br>
Look at it as a matrix such that each row represents:</p>
<ol>
<li>How much of that word is present in each of the <code>r</code> topics that the model has figured out.</li>
<li>So, if row 1 looks like: [0.4, 0.3, 0.2], that would mean that that 0.4 is the relative importance/quantity of the particular word in the topic represented by first column and likewise for 0.3 and 0.2<br></li>
</ol>
<p>In short:<br></p>
<h2 id="1.-Each-column-represents-a-topic.-Each-row-is-a-word-with-it's-relative-importance-for-each-topic.">1. Each column represents a topic. Each row is a word with it's relative importance for each topic.<a class="anchor-link" href="#1.-Each-column-represents-a-topic.-Each-row-is-a-word-with-it's-relative-importance-for-each-topic.">&#182;</a></h2><p>Now, the <code>Sigma</code> matrix can just be looked at as a bunch of scaling factors for each of the topic columns</p>
<hr>
<p>For the <code>Vt</code> Matrix, you can see it as the opposite of the <code>U</code> matrix.</p>
<ol>
<li>Each row represents a topic in this case.</li>
<li>Each column represents a HashTag</li>
<li>The topic in the first row in <code>Vt</code> corresponds to the topic of the first column in <code>U</code></li>
<li>So that means that the words clustered in the first row here are the words that commonly occur in the first topic (cluster of HashTags) in <code>U</code></li>
</ol>
<hr>
<p>Now when we multiply these matrices together, here's what happens:</p>
<ol>
<li>Ignore the middle <code>Sigma</code> Matrix for now and imagine that it is absent</li>
<li>When we multiply the <code>U</code> and <code>Vt</code> Matrices together, here's what happens (taking just the first row/column for now):<ol>
<li>For word #1, let's say you have a row in <code>U</code> representing it's importance in 3 topics such as suspense, science and religion : <code>[wimp1, wimp2, wimp3]</code></li>
<li>For HashTag #1, let's say you have a column in <code>Vt</code> of relative presence of topics along with the word: <code>[wimp1, wimp2, wimp3]</code></li>
<li>On matrix multiplication, you're saying: take how much of "suspense" is generally present with this hashtag, take how much of this word is present when there is "suspense", and multiply them together. Do this for each topic and calculate the sum. This will give me the amount of the word present with the hashtag.</li>
</ol>
</li>
</ol>
<hr>
<p><strong>What about <code>S</code>?</strong><br>
Since some topics are obviously more present than others (a document might have talked about fruits in India, but a lot many other documents would have talked about computer graphics), we need a matrix to express those importances too. And the <code>S</code> matrix is exactly that. It expresses the relative importance of each topic</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Applying-SVD-on-our-newsgroups-dataset">Applying SVD on our newsgroups dataset<a class="anchor-link" href="#Applying-SVD-on-our-newsgroups-dataset">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> U, s, Vh = linalg.svd(vectors, full_matrices=False)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 44 s, sys: 1.7 s, total: 45.7 s
Wall time: 26.2 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">shapes</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(2034, 2034)
(2034,)
(2034, 26576)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>How close is the approximation?</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reconstruct</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">Vh</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">reconstruct</span> <span class="o">-</span> <span class="n">vectors</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3.001252699352258e-12</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Looks like it's pretty close.</em></p>
<p><strong>What about orthogonality?</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Up</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">U</span>
<span class="n">Vp</span> <span class="o">=</span> <span class="n">Vh</span>  <span class="nd">@Vh</span><span class="o">.</span><span class="n">T</span>
<span class="n">shapes</span><span class="p">(</span><span class="n">Up</span><span class="p">,</span> <span class="n">Vp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(2034, 2034)
(2034, 2034)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Up</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">Up</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Vp</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">Vp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(1.7966486886594205e-13, 1.84000430746347e-13)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Okay, how many topics are really important?</strong><br>
As it turns out, not many. This will be more clear on seeing the plots below</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="mi">10</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_top_words</span> <span class="o">=</span> <span class="mi">8</span>

<span class="k">def</span> <span class="nf">show_topics</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="c1"># Get top `num_top_words` from vocab for that topic</span>
    <span class="n">top_words</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">[</span><span class="n">vocab</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">t</span><span class="p">)[:</span><span class="o">-</span><span class="n">num_top_words</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="c1"># do for each topic</span>
    <span class="n">topic_words</span> <span class="o">=</span> <span class="p">([</span><span class="n">top_words</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">A</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">topic_words</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see if our SVD Approach has gotten us something useful by looking at groups of words belonging to different topics accordig to our model</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_topics</span><span class="p">(</span><span class="n">Vh</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;critus ditto propagandist surname galacticentric kindergarten surreal imaginative&#39;,
 &#39;jpeg gif file color quality image jfif format&#39;,
 &#39;graphics edu pub mail 128 3d ray ftp&#39;,
 &#39;jesus god matthew people atheists atheism does graphics&#39;,
 &#39;image data processing analysis software available tools display&#39;,
 &#39;god atheists atheism religious believe religion argument true&#39;,
 &#39;space nasa lunar mars probe moon missions probes&#39;,
 &#39;image probe surface lunar mars probes moon orbit&#39;,
 &#39;argument fallacy conclusion example true ad argumentum premises&#39;,
 &#39;space larson image theory universe physical nasa material&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, all the above lines seem to, more or less, belong to the categories that were actually present in our dataset: Space, Religion, Atheism (overlapping with Religion) and Computer Graphics.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Moving-on:-Non-Negative-Matrix-Factorization-(NMF)">Moving on: Non Negative Matrix Factorization (NMF)<a class="anchor-link" href="#Moving-on:-Non-Negative-Matrix-Factorization-(NMF)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Motivation:">Motivation:<a class="anchor-link" href="#Motivation:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html alt="PCA on faces" style="width: 80%" file="/computational-linear-algebra/images/face_pca.png" %}</p>
<p>(source: <a href="http://perso.telecom-paristech.fr/~essid/teach/NMF_tutorial_ICME-2014.pdf">NMF Tutorial</a>)</p>
<p>A more interpretable approach:</p>
<p>{% include image.html alt="NMF on Faces" style="width: 80%" file="/computational-linear-algebra/images/face_outputs.png" %}</p>
<p>(source: <a href="http://perso.telecom-paristech.fr/~essid/teach/NMF_tutorial_ICME-2014.pdf">NMF Tutorial</a>)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Rather than constraining our factors to be <em>orthogonal</em>, another idea would to constrain them to be <em>non-negative</em>. NMF is a factorization of a non-negative data set $V$: $$ V = W H$$ into non-negative matrices $W,\; H$. Often positive factors will be <strong>more easily interpretable</strong> (and this is the reason behind NMF's popularity).</p>
<p>{% include image.html alt="NMF on faces" style="width: 80%" file="/computational-linear-algebra/images/face_nmf.png" %}</p>
<p>(source: <a href="http://perso.telecom-paristech.fr/~essid/teach/NMF_tutorial_ICME-2014.pdf">NMF Tutorial</a>)</p>
<p>Nonnegative matrix factorization (NMF) is a non-exact factorization that factors into one skinny positive matrix and one short positive matrix.  NMF is NP-hard and non-unique.  There are a number of variations on it, created by adding different constraints.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Applications:">Applications:<a class="anchor-link" href="#Applications:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="http://scikit-learn.org/stable/auto_examples/decomposition/plot_faces_decomposition.html#sphx-glr-auto-examples-decomposition-plot-faces-decomposition-py">Face Decompositions</a></li>
<li><a href="http://www.quuxlabs.com/blog/2010/09/matrix-factorization-a-simple-tutorial-and-implementation-in-python/">Collaborative Filtering, eg movie recommendations</a></li>
<li><a href="https://pdfs.semanticscholar.org/cc88/0b24791349df39c5d9b8c352911a0417df34.pdf">Audio source separation</a></li>
<li><a href="http://ieeexplore.ieee.org/document/1532909/">Chemistry</a></li>
<li><a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-015-0485-4">Bioinformatics</a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2623306/">Gene Expression</a></li>
<li>Topic Modeling (our problem!)</li>
</ul>
<p>{% include image.html alt="NMF on documents" style="width: 80%" file="/computational-linear-algebra/images/nmf_doc.png" %}</p>
<p>(source: <a href="http://perso.telecom-paristech.fr/~essid/teach/NMF_tutorial_ICME-2014.pdf">NMF Tutorial</a>)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>More Reading</strong>:</p>
<ul>
<li><a href="https://arxiv.org/pdf/1401.5226.pdf">The Why and How of Nonnegative Matrix Factorization</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Hyperspectral Unmixing using NMF:</strong>
{% include image.html alt="Hyperspectral Unmixing" style="width: 100%" file="/computational-linear-algebra/images/HySi_unmix.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NMF-Using-sklearn">NMF Using sklearn<a class="anchor-link" href="#NMF-Using-sklearn">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">vectors</span><span class="o">.</span><span class="n">shape</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Guessed number of topics</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">NMF</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">W1</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
<span class="n">H1</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">components_</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">shapes</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">H1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(2034, 5)
(5, 26576)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_topics</span><span class="p">(</span><span class="n">H1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;jpeg image gif file color images format quality&#39;,
 &#39;edu graphics pub mail 128 ray ftp send&#39;,
 &#39;space launch satellite nasa commercial satellites year market&#39;,
 &#39;jesus god people matthew atheists does atheism said&#39;,
 &#39;image data available software processing ftp edu analysis&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="TF-IDF">TF-IDF<a class="anchor-link" href="#TF-IDF">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="http://www.tfidf.com/">Topic Frequency-Inverse Document Frequency</a> (TF-IDF) is a way to normalize term counts by taking into account how often they appear in a document, how long the document is, and how commmon/rare the term is.</p>
<p>TF = (# occurrences of term t in document) / (# of words in documents)</p>
<p>IDF = log(# of documents / # documents with term t in it)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vectorizer_tfidf</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span>
<span class="n">vectors_tfidf</span> <span class="o">=</span> <span class="n">vectorizer_tfidf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="mi">5</span>  <span class="c1"># num topics</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W1</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
<span class="n">H1</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">components_</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_topics</span><span class="p">(</span><span class="n">H1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;jpeg image gif file color images format quality&#39;,
 &#39;edu graphics pub mail 128 ray ftp send&#39;,
 &#39;space launch satellite nasa commercial satellites year market&#39;,
 &#39;jesus god people matthew atheists does atheism said&#39;,
 &#39;image data available software processing ftp edu analysis&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x1a3cd73190&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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nPr7YUlfC7lcAAAAsVVsH6i/t9bulKTU77eFVyQAAIB4K3sncmPMSGNMgzGmoaWlpdyLAwAAKLtiA9RuY8zbJSn1u9nvgdbaMdbaEdbaEcOGDStycQAAAPFRbIB6QdLFqb8vlvR8OMUBAACIvyDTGDwhaZ6k9xhjmowxP5I0WtLnjDHrJX0u9T8AAEBdGFroAdbai3zuOifksgAAAFQFZiIHAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwRIACAABwVFKAMsb8P2PMKmPMSmPME8aY14VVMAAAgLgqOkAZY46X9DNJI6y1H5Q0RNKFYRUMAAAgrkptwhsq6fXGmKGS3iBpR+lFAgAAiLeiA5S1drukP0naKmmnpDZr7cthFQwAACCuSmnCO1bSBZJOlvQOSccYY77r8biRxpgGY0xDS0tL8SUFAACIiVKa8M6VtMla22Kt7ZH0jKQzcx9krR1jrR1hrR0xbNiwEhYHAAAQD6UEqK2SzjDGvMEYYySdI2lNOMUCAACIr1L6QC2Q9LSkxZJWpF5rTEjlAgAAiK2hpTzZWnuVpKtCKgsAAEBVYCZyAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAARwQoAAAA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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">reconstruction_err_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>683.3993486215703</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="NMF-in-Summary:">NMF in Summary:<a class="anchor-link" href="#NMF-in-Summary:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Benefits: Fast and easy to use</p>
<p>Downsides: Took years of research and expertise to create</p>
<p>Notes:</p>
<ul>
<li>For NMF, the matrix needs to be atleast as tall as it is wide, or we get an error with fit_transform</li>
<li>Can use df_min in CountVectorizer to only look at words that were in at least k of the split texts</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NMF-from-scratch-in-NumPy,-using-SGD">NMF from scratch in NumPy, using SGD<a class="anchor-link" href="#NMF-from-scratch-in-NumPy,-using-SGD">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gradient-Descent:">Gradient Descent:<a class="anchor-link" href="#Gradient-Descent:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The key idea of standard <strong>gradient descent</strong></p>
<ol>
<li>Randomly choose some weights to start</li>
<li>Loop:<ul>
<li>Use weights to calculate a prediction</li>
<li>Calculate the derivatives of the loss</li>
<li>Update the weights</li>
</ul>
</li>
<li>Repeat step 2 a lot of times. Eventually we end up with some descent weights</li>
</ol>
<p><strong>Key</strong>: We want to decrease our loss and the derivative tells us the direction of <strong>steepest descent</strong></p>
<p>Note that the loss, error and cost are all terms used to describe the same thing.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stochastic-Gradient-Descent-(SGD)">Stochastic Gradient Descent (SGD)<a class="anchor-link" href="#Stochastic-Gradient-Descent-(SGD)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Stochastic Gradient Descent</strong> is an incredibly useful optimization method (it is also the heart of deep learning, wehre it is used for backpropagation). For standard gradient descent, we evaluate the loss using all out data, which can be really slow. In stochastic gradient descent, we evaluate our loss function on just a sample of our data (sometimes called a mini batch). We would get different loss values on different samples of the data, so this is why it is stochastic. It turns out that this is still an effective way to optimize, and it's much more efficient!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Applying-SGD-to-NMF">Applying SGD to NMF<a class="anchor-link" href="#Applying-SGD-to-NMF">&#182;</a></h4><p><strong>Goal</strong>: Decompose $V\;(m \times n)$ into $$V \approx WH$$ where $W\; (m \times d)$ and $H\; (d \times n)$, $W,\;H\;&gt;=\;0$, and we've minimized the Frobenius norm of $V-WH$.</p>
<p><strong>Approach</strong>: We will pick random positive $W$ &amp; $H$, and then use SGD to optimize.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lam</span><span class="o">=</span> <span class="mf">1e3</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-2</span>
<span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="o">=</span> <span class="n">vectors_tfidf</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W1</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
<span class="n">H1</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">components_</span>
<span class="n">show_topics</span><span class="p">(</span><span class="n">H1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;jpeg image gif file color images format quality&#39;,
 &#39;edu graphics pub mail 128 ray ftp send&#39;,
 &#39;space launch satellite nasa commercial satellites year market&#39;,
 &#39;jesus god people matthew atheists does atheism said&#39;,
 &#39;image data available software processing ftp edu analysis&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">penalty</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="s2">&quot;Penalty for negative values in M&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">M</span><span class="o">&gt;=</span><span class="n">mu</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="n">mu</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="k">def</span> <span class="nf">grads</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
    <span class="s2">&quot;Gradients of W and H with respect to the loss assuming that the loss function is MSE (NORM of error)&quot;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">W</span><span class="nd">@H</span> <span class="o">-</span> <span class="n">M</span> <span class="c1"># First gradient in the chain before the loss</span>
    <span class="k">return</span> <span class="n">R</span><span class="nd">@H</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">penalty</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">lam</span><span class="p">,</span> <span class="n">W</span><span class="o">.</span><span class="n">T</span><span class="nd">@R</span> <span class="o">+</span> <span class="n">penalty</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">lam</span> <span class="c1"># dW, dH</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">upd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">lr</span><span class="p">):</span>
    <span class="s2">&quot;Update step of SGD&quot;</span>
    <span class="n">dW</span><span class="p">,</span> <span class="n">dH</span> <span class="o">=</span> <span class="n">grads</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
    <span class="n">W</span> <span class="o">-=</span> <span class="n">lr</span><span class="o">*</span><span class="n">dW</span>
    <span class="n">H</span> <span class="o">-=</span> <span class="n">lr</span><span class="o">*</span><span class="n">dH</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
    <span class="s2">&quot;Show progress&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">W</span><span class="nd">@H</span><span class="p">),</span> <span class="n">W</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">H</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="p">(</span><span class="n">W</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="p">(</span><span class="n">H</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Starting off with random values for W and H</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">d</span><span class="p">)))</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">report</span><span class="p">(</span><span class="n">vectors_tfidf</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>44.42543379094396 1.5373838071988187e-06 1.6788872879090616e-07 0 0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">upd</span><span class="p">(</span><span class="n">vectors_tfidf</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">lr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">report</span><span class="p">(</span><span class="n">vectors_tfidf</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>44.412026276810735 -0.0006871114752087324 -7.027552262535157e-05 124 290
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span> 
    <span class="n">upd</span><span class="p">(</span><span class="n">vectors_tfidf</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">lr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">report</span><span class="p">(</span><span class="n">vectors_tfidf</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>44.40670983905107 -0.0006661163109345714 -6.345978849354066e-05 111 286
44.37082552090174 -0.0003025578440784557 -4.279892843903037e-05 37 580
44.341524308781786 -0.0002586654966122247 -6.587059787294088e-05 43 979
44.308718713432015 -0.0001673566326960437 -7.961156170157397e-05 40 1626
44.27319800463694 -0.00015505737551882136 -0.00010182009818433227 34 2368
44.2385371386353 -0.00010787158621094049 -0.00012389594094950603 33 3239
44.20819486943194 -7.504619359861324e-05 -0.0001319430802911279 33 4000
44.183708308109686 -0.00013492510660893263 -0.0001773813663598892 50 4876
44.164767625548826 -0.00010639653378621892 -0.0001321011236404995 53 5703
44.15001925934274 -0.00031595643051958753 -0.00014052665866284194 65 6404
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_topics</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;space just don people god like think know&#39;,
 &#39;god people don think space just like know&#39;,
 &#39;don people space god like think know just&#39;,
 &#39;just god people don space think like know&#39;,
 &#39;god know space think people don just like&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparing-Approaches">Comparing Approaches<a class="anchor-link" href="#Comparing-Approaches">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Scikit-Learn's-NMF">Scikit-Learn's NMF<a class="anchor-link" href="#Scikit-Learn's-NMF">&#182;</a></h4><ul>
<li>Fast</li>
<li>No parameter tuning</li>
<li>Relies on decades of academic research, took experts a long time to implement</li>
</ul>
<p>{% include image.html alt="research on NMF" style="width: 80%" file="/computational-linear-algebra/images/nimfa.png" %}
source: <a href="http://nimfa.biolab.si/">Python Nimfa Documentation</a></p>
<h4 id="Using-PyTorch-and-SGD">Using PyTorch and SGD<a class="anchor-link" href="#Using-PyTorch-and-SGD">&#182;</a></h4><ul>
<li>Took us an hour to implement, didn't have to be NMF experts</li>
<li>Parameters were fiddly</li>
<li>Not as fast (tried in numpy and was so slow we had to switch to PyTorch)</li>
</ul>

</div>
</div>
</div>
</div>
 

